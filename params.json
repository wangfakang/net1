{"name":"Net1","tagline":"tcp 三次握手time_wait","body":"`三次握手四次挥手的过程：`   \r\n\r\n1.tcp协议的简单讲解：  \r\n===\r\n　　　首先tcp是位于传输层的协议，tcp协议的特点：面向连接，字节流，可靠传输等特点．\r\n\r\n2.tcp方式建立的三次握手过程：   \r\n===\r\n　　　首先client想server端发送syn（同步报文段）此时client的状态变为synsend，当server端      \r\n　　　收到的时候其server状态变为synrecved.此时server进行向client发送syn 和　ack报文，当    \r\n　　　client收到的时候server端的syn ack的时候则client状态变化为estableished,然后给server   \r\n　　　发送ack当server端收到ack的时候则完成了三次握手，server状态变化为estableished.   \r\n\r\n3.tcp断开连接时的四次挥手：    \r\n===\r\n　　　为何建立连接的时候就只需要三次握手，而断开连接的时候就要四次挥手恩？原因很简单，由   \r\n　　　于此种建立的连接是双向的，要彼此都断开才是真的断开了，否则会处于一种半连接状态．   \r\n　　　其过程如下：           \r\n\r\n　　　当client向server发送fin（结束报文）的时候，此时client的状态就变成fin_wait_1,当server收到      \r\n　　　的时候就会向client发送ack此时client收到的时候client变为fin_wait_2而且server处于closed_wait，          \r\n　　　此时状态就是一种半连接状态，方式二：此时如果server发送fin +ack的话则client直接变为time_wait,   \r\n　　　server变为last_ack状态．最后当client发送ack,server收到的话就变成了close_wait.    \r\n　　　注意：      \r\n　　　上面提到的client变为time_wait状态，注意处于time_wait默认状态下，该连接是不可用的．之所以存在\r\n　　　一个time_wait状态，原因就是有可能server端没有收到c发的ack所以此时s会继续发送一个fin让其c给回复\r\n　　　ack.所以此时的c的连接是不可以与其他进行建立连接．    \r\n　　　默认：     \r\n　　　time_wait的时间是２倍的MSL(MSL:是报文段的最大生存时间)，之所time_wait设置为2MSL,这样可以进行\r\n　　　迟来的报文进行丢弃．      \r\n\r\n4.什么情况下我们会收到一个rst(复位报文段)： \r\n===\r\n　　第一种：当我们访问一个不存在的一个端口的时候．   \r\n　　第二种：当向处于time_wait的状态的端口发送连接．   \r\n　　第三种：当向半连接状态的对端写数据的时候（注意对端是指主动断开的一端）．   \r\n　　第四种：异常终止对方连接，可以向对端发送一个rst进行断开．   \r\n\r\n\r\n5.tcp报文的结构：  \r\n===\r\n   \r\n---------------------------------------------------\r\n\r\n　　16位源端口　　　　　　　　　　　16位目标端口    \r\n　\r\n\r\n                     32位序列号       \r\n　　　　　　　　　\r\n                     32位确认号　     \r\n4位头部长度　６　U A P R S F   　 16位窗口大小      \r\n \r\n 16位校验和　　　　　　　　　　　　16位紧急指针　      \r\n               \r\n                    选项最多40字节    \r\n   　　　　　　 \r\n-------------------------------------------------\r\n\r\n相关6个标志位解释：       \r\n\r\nURG:紧急数据指针    \r\nACK:确认    \r\nPSH:立即接受缓冲区数据   \r\nRST:复位   \r\nSYN:同步    \r\nFIN:结束报文   \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n　\r\n\r\n欢迎一起交流学习 \r\n====\r\n \r\n在使用中有任何问题，欢迎反馈给我，可以用以下联系方式跟我交流\r\n\r\n* 邮件(1031379296#qq.com, 把#换成@)\r\n* QQ: 1031379296\r\n* weibo: [@王发康](http://weibo.com/u/2786211992/home)\r\n\r\n\r\nThx\r\n====\r\n\r\n* chunshengsterATgmail.com\r\n\r\n\r\nAuthor\r\n====\r\n* Linux\\nginx\\golang\\c\\c++爱好者\r\n* 欢迎一起交流  一起学习# \r\n* Others say good and Others good\r\n\r\n\r\n","google":"tcp time_wait 三次握手　四次挥手","note":"Don't delete this file! It's used internally to help with page regeneration."}